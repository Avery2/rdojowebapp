<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rdojo Kombat Timer</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Mobile Sticky Header -->
    <div class="mobile-header" id="mobileHeader">
        <div class="mobile-fighter">
            <div class="mobile-fighter-name" id="mobileNameA">Fighter A</div>
            <div class="mobile-score" id="mobileScoreA">0</div>
            <div class="mobile-countdown" id="mobileCountdownA" style="display: none;"></div>
        </div>
        <div class="mobile-timer">
            <div class="mobile-round" id="mobileRound">R1</div>
            <div class="mobile-time" id="mobileTime">3:00</div>
        </div>
        <div class="mobile-fighter">
            <div class="mobile-fighter-name" id="mobileNameB">Fighter B</div>
            <div class="mobile-score" id="mobileScoreB">0</div>
            <div class="mobile-countdown" id="mobileCountdownB" style="display: none;"></div>
        </div>
    </div>

    <div class="container">
        <div class="header">
            <h1>RDOJO KOMBAT TIMER</h1>
            <div class="match-status" id="matchStatus">Ready to Start</div>
        </div>

        <div class="main-grid">
            <!-- Fighter A -->
            <div class="fighter-card fighter-a" id="fighterACard">
                <div class="fighter-name" id="fighterANameDisplay">Fighter A</div>
                <div class="fighter-score" id="scoreA">0</div>
                <div class="fighter-countdown" id="countdownA"></div>
                <div class="rounds-won">
                    Rounds Won: <span id="roundsWonA">0</span>
                    <div class="rounds-indicator">
                        <div class="round-dot" id="roundDotA1"></div>
                        <div class="round-dot" id="roundDotA2"></div>
                        <div class="round-dot" id="roundDotA3"></div>
                    </div>
                </div>
            </div>

            <!-- Timer Section -->
            <div class="timer-section">
                <div class="round-info" id="roundInfo">Round 1 of 3 (Max: 30 pts)</div>
                <div class="timer" id="timer">3:00</div>
                <div class="button-group">
                    <button class="btn-primary" id="startBtn" onclick="startMatch()">Start Match</button>
                    <button class="btn-warning" id="pauseBtn" onclick="togglePause()" disabled>Pause</button>
                    <button class="btn-danger" id="resetBtn" onclick="showResetOptions()">Reset</button>
                    <button class="btn-secondary" id="settingsBtn" onclick="toggleSettings()">Settings</button>
                    <button class="btn-multiplayer" id="multiplayerBtn" onclick="toggleMultiplayer()">Multiplayer</button>
                </div>
                <div id="multiplayerStatus" class="multiplayer-status"></div>
            </div>

            <!-- Fighter B -->
            <div class="fighter-card fighter-b" id="fighterBCard">
                <div class="fighter-name" id="fighterBNameDisplay">Fighter B</div>
                <div class="fighter-score" id="scoreB">0</div>
                <div class="fighter-countdown" id="countdownB"></div>
                <div class="rounds-won">
                    Rounds Won: <span id="roundsWonB">0</span>
                    <div class="rounds-indicator">
                        <div class="round-dot" id="roundDotB1"></div>
                        <div class="round-dot" id="roundDotB2"></div>
                        <div class="round-dot" id="roundDotB3"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Controls -->
        <div class="controls">
            <div class="control-section">
                <h3>Control Position <span class="keyboard-hint">(‚Üê ‚Üì ‚Üí) or (1 2 3)</span></h3>
                <div class="button-group">
                    <button class="btn-fighter-a" id="controlABtn" onclick="setControl('A')">
                        <span id="controlABtnLabel">Fighter A</span>
                        <span class="key-hint">‚Üê / 1</span>
                    </button>
                    <button class="btn-neutral btn-active" id="controlNoneBtn" onclick="setControl('none')">
                        No Control
                        <span class="key-hint">‚Üì / 2</span>
                    </button>
                    <button class="btn-fighter-b" id="controlBBtn" onclick="setControl('B')">
                        <span id="controlBBtnLabel">Fighter B</span>
                        <span class="key-hint">‚Üí / 3</span>
                    </button>
                </div>
            </div>

            <div class="control-section">
                <h3>End Round</h3>
                <div class="button-group">
                    <button class="btn-danger" onclick="showRoundEndModal('submission')">
                        Submission
                    </button>
                    <button class="btn-danger" onclick="showRoundEndModal('stoppage')">
                        Stoppage
                    </button>
                </div>
            </div>

            <div class="keyboard-shortcuts">
                <strong>Keyboard Shortcuts:</strong>
                <span>Space = Start/Pause</span>
                <span>‚Üê or 1 = Fighter A Control</span>
                <span>‚Üì or 2 = No Control</span>
                <span>‚Üí or 3 = Fighter B Control</span>
                <span>S = Settings</span>
            </div>
        </div>

        <!-- Round History -->
        <div class="round-history" id="roundHistory" style="display: none;">
            <h3>Round History</h3>
            <div id="historyList"></div>
        </div>

        <!-- Match Winner -->
        <div class="match-winner" id="matchWinner" style="display: none;">
            <h2>üèÜ MATCH WINNER üèÜ</h2>
            <div id="winnerText" style="font-size: 2rem; margin-top: 15px;"></div>
        </div>
    </div>

    <!-- Round End Modal -->
    <div class="modal round-end-modal" id="roundEndModal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="roundEndTitle">End Round</h2>
                <button class="modal-close" onclick="closeRoundEndModal()">√ó</button>
            </div>
            <div class="modal-body">
                <h3>Which fighter won?</h3>
                <div class="button-group">
                    <button class="btn-fighter-a" id="roundEndFighterA" onclick="confirmRoundEnd('A')">
                        Fighter A
                    </button>
                    <button class="btn-fighter-b" id="roundEndFighterB" onclick="confirmRoundEnd('B')">
                        Fighter B
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Reset Modal -->
    <div class="modal" id="resetModal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Reset Options</h2>
                <button class="modal-close" onclick="closeResetModal()">√ó</button>
            </div>
            <div class="modal-body">
                <h3>Choose what you want to reset:</h3>
                <div class="button-group" style="flex-direction: column; gap: 15px; margin-top: 20px;">
                    <button class="btn-danger" onclick="confirmReset('full')" style="width: 100%; padding: 20px;">
                        <div style="font-size: 1.2rem; margin-bottom: 5px;">Reset Entire Match</div>
                        <div style="font-size: 0.85rem; opacity: 0.9; text-transform: none; font-weight: normal;">Clear all rounds and start fresh</div>
                    </button>
                    <button class="btn-warning" onclick="confirmReset('round1')" style="width: 100%; padding: 20px;">
                        <div style="font-size: 1.2rem; margin-bottom: 5px;">Reset from Round 1</div>
                        <div style="font-size: 0.85rem; opacity: 0.9; text-transform: none; font-weight: normal;">Keep fighter names, clear all progress</div>
                    </button>
                    <button class="btn-warning" onclick="confirmReset('round2')" style="width: 100%; padding: 20px;">
                        <div style="font-size: 1.2rem; margin-bottom: 5px;">Reset from Round 2</div>
                        <div style="font-size: 0.85rem; opacity: 0.9; text-transform: none; font-weight: normal;">Keep Round 1 results, reset from Round 2</div>
                    </button>
                    <button class="btn-warning" onclick="confirmReset('round3')" style="width: 100%; padding: 20px;">
                        <div style="font-size: 1.2rem; margin-bottom: 5px;">Reset from Round 3</div>
                        <div style="font-size: 0.85rem; opacity: 0.9; text-transform: none; font-weight: normal;">Keep Rounds 1-2 results, reset Round 3</div>
                    </button>
                    <button class="btn-secondary" onclick="closeResetModal()" style="width: 100%; padding: 15px;">
                        Cancel
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div class="modal" id="settingsModal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Settings</h2>
                <button class="modal-close" onclick="toggleSettings()">√ó</button>
            </div>
            <div class="modal-body">
                <div class="settings-section">
                    <h3>Fighter Names</h3>
                    <div class="input-group">
                        <label for="fighterANameInput">Fighter A Name:</label>
                        <input type="text" id="fighterANameInput" placeholder="Fighter A" maxlength="20">
                    </div>
                    <div class="input-group">
                        <label for="fighterBNameInput">Fighter B Name:</label>
                        <input type="text" id="fighterBNameInput" placeholder="Fighter B" maxlength="20">
                    </div>
                </div>
                <div class="settings-section">
                    <h3>Edit Current Round Scores</h3>
                    <div class="input-group">
                        <label for="editScoreA">Fighter A Score:</label>
                        <input type="number" id="editScoreA" min="0" value="0">
                    </div>
                    <div class="input-group">
                        <label for="editScoreB">Fighter B Score:</label>
                        <input type="number" id="editScoreB" min="0" value="0">
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-primary" onclick="saveSettings()">Save Changes</button>
                <button class="btn-secondary" onclick="toggleSettings()">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Multiplayer Modal -->
    <div class="modal" id="multiplayerModal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Multiplayer Timer</h2>
                <button class="modal-close" onclick="closeMultiplayerModal()">√ó</button>
            </div>
            <div class="modal-body">
                <div id="multiplayerOptions">
                    <h3>Share timer with a friend</h3>
                    <p style="font-size: 0.9rem; opacity: 0.8; margin-bottom: 20px;">
                        Both devices will see the same timer. Only the host can control it.
                    </p>
                    <div class="button-group" style="flex-direction: column; gap: 15px;">
                        <button class="btn-primary" onclick="createMultiplayerRoom()" style="width: 100%; padding: 20px;">
                            <div style="font-size: 1.2rem; margin-bottom: 5px;">Host Timer</div>
                            <div style="font-size: 0.85rem; opacity: 0.9; text-transform: none; font-weight: normal;">Create a room and share the code</div>
                        </button>
                        <button class="btn-secondary" onclick="showJoinRoom()" style="width: 100%; padding: 20px;">
                            <div style="font-size: 1.2rem; margin-bottom: 5px;">Join Timer</div>
                            <div style="font-size: 0.85rem; opacity: 0.9; text-transform: none; font-weight: normal;">Enter a room code to join</div>
                        </button>
                    </div>
                </div>

                <div id="hostRoomSection" style="display: none;">
                    <h3>Room Created!</h3>
                    <p style="font-size: 0.9rem; opacity: 0.8; margin-bottom: 15px;">
                        Share this code with your friend:
                    </p>
                    <div style="background: #2a2a2a; padding: 30px; border-radius: 8px; text-align: center; margin-bottom: 20px;">
                        <div style="font-size: 3rem; font-weight: bold; letter-spacing: 8px; color: #4CAF50;" id="roomCodeDisplay">ABC123</div>
                    </div>
                    <p style="font-size: 0.85rem; opacity: 0.7; margin-bottom: 20px;">
                        Your friend should click "Join Timer" and enter this code. You can control the timer, and they'll see it update in real-time.
                    </p>
                    <button class="btn-primary" onclick="closeMultiplayerModal()" style="width: 100%;">Start Timer</button>
                </div>

                <div id="joinRoomSection" style="display: none;">
                    <h3>Join Timer Room</h3>
                    <p style="font-size: 0.9rem; opacity: 0.8; margin-bottom: 15px;">
                        Enter the room code from your friend:
                    </p>
                    <input type="text" id="roomCodeInput" placeholder="Enter 6-character code" maxlength="6"
                           style="width: 100%; padding: 15px; font-size: 1.2rem; text-align: center; letter-spacing: 4px; margin-bottom: 20px; text-transform: uppercase;">
                    <div class="button-group" style="gap: 10px;">
                        <button class="btn-primary" onclick="joinMultiplayerRoom()">Join</button>
                        <button class="btn-secondary" onclick="showMultiplayerOptions()">Back</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer style="text-align: center;">
    <a href="https://github.com/Avery2/rdojowebapp">Github</a>
</footer>

    <!-- JavaScript Files -->
    <script src="config.js"></script>
    <script src="state.js"></script>
    <script src="sound.js"></script>
    <script src="game-logic.js"></script>
    <script src="simple-multiplayer.js"></script>
    <script src="app.js"></script>
    <script src="mobile.js"></script>
</body>
</html>
